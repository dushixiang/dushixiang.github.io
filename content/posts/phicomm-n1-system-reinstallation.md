+++
date = '2024-01-28T19:31:00+08:00'
draft = false
title = '记一次曲折的N1盒子重装系统经历'
+++

## 为什么要重装系统？

倒不是为了折腾，而是我手上这台斐讯 N1 盒子（armbian系统）在上个月让我不小心 `rm -rf /` 全给删除了，等我反应过来的时候已经为时已晚。

由于 Linux 系统的特性，我运行的程序只要不重启系统都还能正常使用，我也懒得立刻处理，就这样挺到了现在。终于在本周五下班之后我心血来潮，准备给它重装一个系统，但没有想到让我花费了将近10个小时。

## 第一个坑，垃圾百度云盘下载速度感人

N1 盒子是一个比较老的设备了，刷机救砖教程也都是2020年或者更早的时候发布的，那个时候恩山论坛上的大佬主要还是用百度云盘来共享工具。

每秒100KB的下载速度下载1个多GB的资料让人等的着急。

## 第二个坑，刷机工具版本之坑

Amlogic线刷工具 USB Burning Tool 有两个版本 v3.1.0 和 v2.2.4，理论上来说 v3.1.0 是新的版本，所以我刚开始安装的也是这个版本，但是我在使用的过程中各种错误，而且分辨率在我4k的屏幕上表现也很糟糕，最后下载了 v2.2.4 才能正常使用。

## 第三个坑，刷机工具识别不到设备

前面说了，我的盒子不是原来的安卓系统了，现在运行的是 armbian，而且系统被我破坏了无法正常启动。也就导致常规手段都无法让工具识别，我看到有人说设备先不要供电，先在工具导入烧录包，然后点击【开始】，并且在3秒内迅速上电就可以识别到并且刷机了，我像个傻子一样尝试了很多遍。

消息来源：https://www.right.com.cn/forum/thread-4041517-1-1.html

## 第四个坑，刷机报错

本来不想拆的，因为麻烦，但最终没有其他办法的我还是拆机进行了短接，需要一把非常细且长的螺丝刀和一个镊子进行短接，幸亏我乱七八糟的工具比较多，翻箱倒柜找到了合适的工具。

我上一次刷机还是几年前，具体的过程我已经忘记了，这次我也只下载了一个 N1 的固件，刷的时候进度到 1% 就报错了，然后就看到说要先刷 T1 的固件，因为需要 T1 固件中前面的一部分，我又从百度云盘下载了 T1 的固件，并且严格安装网上的教程来尝试，不幸的是还是失败了。

又看到有人说可能是USB口的问题，我便把电脑上的6个USB口都试了一遍，还是行不通。

上网又查了一下，说是AMD硬件的问题，换了因特尔的就好了。

WTF？？？

这个时候已经凌晨一点钟，搞得我心态爆炸。感觉面对这种【黑盒子】太无力了，竟然还有人能享受这个过程，我是无法理解的。

总之周五晚上从7点钟干到凌晨1点钟并没有解决这个问题。

## 第五个坑，U盘启动

周六的时候我又测试了几遍刷机的方案，还是行不通，我便想着使用常规Windows和Linux装系统的方案，使用 U盘 启动来装系统。

搜索了一下找到了这个项目 https://github.com/ophub/amlogic-s9xxx-armbian ，从release下载到了合适的固件，之后找了一个U盘搭配 rufus 把固件写入到了 U盘。

我便开始了U盘启动之旅，尴尬的是 N1 并没有 BIOS 这个东西，我查询到的U盘启动方案都是在原来安卓系统下，使用 telnet 连接上之后执行指令来控制从U盘启动，但是我的 N1 在启动之后会卡在启动 armbian 失败的页面上。

我从F1到F12，加上各种组合按键都没能让N1盒子从U盘启动，在微信群聊里面吐槽了一下，然后群友回复我说要用读卡器+SD卡来搞，但是我上哪找读卡器和SD卡啊....

## 第六个坑，把固件写入到eMMC

你永远无法意料下一秒会发生什么，在我心态爆炸，打算最后一次尝试，给N1上电之后，胡乱拍击键盘的时候，N1进入了U盘启动，加载了U盘中的armbian系统。

至今我都不知道按下哪几个键才能U盘启动，但是不影响我知道这是一个千载难逢的机会，我按照教程执行了 `armbian-install` 并且把固件写入到了`eMMC` 中，安装成功之后进行重启，迫不及待的拔掉U盘进行测试。

然后我就看到了新的启动失败信息，在我插上U盘之后又可以正常启动了。

让我产生了新的疑问，难道不支持把固件写入到eMMC？

这个时候说实话我已经花费了太多时间，只想让它能用就行了，只能U盘启动的话，也就凑合凑合用吧。

在我执行更新、安装软件、因为网络问题搞了大半天之后（国外的源太慢了），我发现每当我敲击一个命令都需要1-2秒才能有反应，搞了一会发现实在是无法忍受这么慢的速度，测试了一下IO速度，更是卡的没反应。

我便决定再重新安装一次 `armbian`，这次我在安装成功之后没有立刻拔出U盘，重启的时候也没有拔掉，发现在重启系统的时候它后台又做了很多操作，我就知道我上一次拔U盘太早了。

:)

----

最后，我终于把N1重装好了系统。


