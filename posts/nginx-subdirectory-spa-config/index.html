<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="今天配置了一个 Nginx 的二级目录单页应用，搞了好久才配置好，记录一下。
正确的配置方式示例：
# 子应用
location /subapp/ {
    alias /opt/app/subapp/; 
    index index.html;
    try_files $uri /subapp/index.html;
}

# 根应用
location / {
    root   /opt/app/web;
    index  index.html index.htm;
    try_files $uri /index.html;
}
坑1: 使用 alias 而不是 root
Nginx 的 root 会把 location 的匹配部分也拼接进去，所以访问：
https://yourdomain/subapp/
实际会去找：
/opt/app/subapp/subapp/index.html
这就多了一层 subapp 目录，通常会 404。
注意 alias 最后必须加 / 。
坑2: try_files 地址要写 /subapp/index.html
之前写的 /index.html 让我误以为是被 / 根应用拦截了，实际上是找错 html 了。"><title>Nginx 二级目录单页应用的正确配置方式</title><link rel="shortcut icon" type=image/x-icon href=/><link rel=stylesheet href=/css/main.0568d3f70e9896300444ff10565468b82c2dace6b1b82bc72fba6ae51bfb0849887e0eb4ccb3cdb1c915fbe68c7000fbea631be9322fd5d0bcab56732ce7293f.css integrity="sha512-BWjT9w6YljAERP8QVlRouCwtrOaxuCvHL7pq5Rv7CEmIfg60zLPNsckV++aMcAD76mMb6TIv1dC8q1ZzLOcpPw=="></head><body a=auto><main class=page-content aria-label=Content><div class=w><div class=post-meta><a href=/>..</a><p><time datetime="2025-09-05 17:03:53 +0800 +0800">2025-09-05</time></p></div><article><h1>Nginx 二级目录单页应用的正确配置方式</h1><p>今天配置了一个 Nginx 的二级目录单页应用，搞了好久才配置好，记录一下。</p><p>正确的配置方式示例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#6272a4># 子应用</span>
</span></span><span style=display:flex><span>location /subapp/ <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>alias</span> /opt/app/subapp/; 
</span></span><span style=display:flex><span>    index index.html;
</span></span><span style=display:flex><span>    try_files <span style=color:#8be9fd;font-style:italic>$uri</span> /subapp/index.html;
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4># 根应用</span>
</span></span><span style=display:flex><span>location / <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    root   /opt/app/web;
</span></span><span style=display:flex><span>    index  index.html index.htm;
</span></span><span style=display:flex><span>    try_files <span style=color:#8be9fd;font-style:italic>$uri</span> /index.html;
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><h3 id=坑1-使用-alias-而不是-root>坑1: 使用 <code>alias</code> 而不是 <code>root</code></h3><p>Nginx 的 root 会把 location 的匹配部分也拼接进去，所以访问：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>https://yourdomain/subapp/
</span></span></code></pre></div><p>实际会去找：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>/opt/app/subapp/subapp/index.html
</span></span></code></pre></div><p>这就多了一层 <code>subapp</code> 目录，通常会 404。</p><p>注意 alias 最后必须加 <code>/</code> 。</p><h3 id=坑2-try_files-地址要写-subappindexhtml>坑2: try_files 地址要写 <code>/subapp/index.html</code></h3><p>之前写的 <code>/index.html</code> 让我误以为是被 <code>/</code> 根应用拦截了，实际上是找错 html 了。</p></article></div></main></body></html>