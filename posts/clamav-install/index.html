<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content='Clam AntiVirus（ClamAV）是免费而且开放源代码的杀毒软件，软件与病毒码的更新皆由社群免费发布。Github 地址：https://github.com/Cisco-Talos/clamav
安装 ClamAV
yum install -y clamav*
配置 ClamAV
cat > /etc/freshclam.conf <<EOF
# 数据库配置文件夹
DatabaseDirectory /var/lib/clamav
# 更新日志文件夹
UpdateLogFile /var/log/freshclam.log
# 日志大小
LogFileMaxSize 2M
# 日志记录时间
LogTime yes
# 所属用户
DatabaseOwner root
# 同步病毒库的地址
DatabaseMirror database.clamav.net
EOF
更新病毒库
大概需要几分钟时间
freshclam
进行病毒扫描测试
clamscan -ri </path1/to/scan> </path2/to/scan>
常用配置说明
--recursive[=yes/no(*)]     -r      递归查找
--infected                  -I      只打印受影响的文件信息
--remove[=yes/no(*)]                删除受影响的文件。(不建议使用,根据扫描结果进行手动删除,避免误删。)
配置邮箱
如果不需要邮件通知的可以忽略此步骤。
安装邮件服务
yum install -y mailx
修改配置
修改大写字母为你的邮箱配置
cat > /etc/mail.rc <<EOF
set from=USERNAME@YOURDOMAIN.COM
set smtp=smtps://smtp.exmail.qq.com:465
set smtp-auth=login
set smtp-auth-user=USERNAME@YOURDOMAIN.COM
set smtp-auth-password=YOURPASSWORD
set ssl-verify=ignore
set nss-config-dir=/etc/pki/nssdb/
EOF
发送邮件进行测试
echo "Your message" | mail -v -s "Message Subject" email@address
如果出现 “Error in certificate: Peer&rsquo;s certificate issuer is not recognized” 属于正常。'><title>Linux 杀毒软件 ClamAV 安装</title><link rel="shortcut icon" type=image/x-icon href=/><link rel=stylesheet href=/css/main.51652302d3a998bf7887aed5c2cf89141bbebdf45a2c8f87b0717a3cf4f51c4e53c694c328fb1de78c3a625a1c01f80745bf1f2f42c040647a245cbbb6c2d1d7.css integrity="sha512-UWUjAtOpmL94h67Vws+JFBu+vfRaLI+HsHF6PPT1HE5TxpTDKPsd54w6YlocAfgHRb8fL0LAQGR6JFy7tsLR1w=="></head><body a=auto><main class=page-content aria-label=Content><div class=w><div class=post-meta><a href=/>..</a><p><time datetime="2022-03-07 21:52:00 +0800 +0800">2022-03-07</time></p></div><article><h1>Linux 杀毒软件 ClamAV 安装</h1><p><strong>Clam AntiVirus</strong>（<strong>ClamAV</strong>）是免费而且开放源代码的杀毒软件，软件与病毒码的更新皆由社群免费发布。Github 地址：https://github.com/Cisco-Talos/clamav</p><h3 id=安装-clamav>安装 ClamAV</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install -y clamav*
</span></span></code></pre></div><h3 id=配置-clamav>配置 ClamAV</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat &gt; /etc/freshclam.conf <span style=color:#e6db74>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 数据库配置文件夹
</span></span></span><span style=display:flex><span><span style=color:#e6db74>DatabaseDirectory /var/lib/clamav
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 更新日志文件夹
</span></span></span><span style=display:flex><span><span style=color:#e6db74>UpdateLogFile /var/log/freshclam.log
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 日志大小
</span></span></span><span style=display:flex><span><span style=color:#e6db74>LogFileMaxSize 2M
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 日志记录时间
</span></span></span><span style=display:flex><span><span style=color:#e6db74>LogTime yes
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 所属用户
</span></span></span><span style=display:flex><span><span style=color:#e6db74>DatabaseOwner root
</span></span></span><span style=display:flex><span><span style=color:#e6db74># 同步病毒库的地址
</span></span></span><span style=display:flex><span><span style=color:#e6db74>DatabaseMirror database.clamav.net
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div><h3 id=更新病毒库>更新病毒库</h3><p>大概需要几分钟时间</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>freshclam
</span></span></code></pre></div><h3 id=进行病毒扫描测试>进行病毒扫描测试</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>clamscan -ri &lt;/path1/to/scan&gt; &lt;/path2/to/scan&gt;
</span></span></code></pre></div><p>常用配置说明</p><pre tabindex=0><code>--recursive[=yes/no(*)]     -r      递归查找
--infected                  -I      只打印受影响的文件信息
--remove[=yes/no(*)]                删除受影响的文件。(不建议使用,根据扫描结果进行手动删除,避免误删。)
</code></pre><h3 id=配置邮箱>配置邮箱</h3><p>如果不需要邮件通知的可以忽略此步骤。</p><h4 id=安装邮件服务>安装邮件服务</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install -y mailx
</span></span></code></pre></div><h4 id=修改配置>修改配置</h4><p>修改大写字母为你的邮箱配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat &gt; /etc/mail.rc <span style=color:#e6db74>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set from=USERNAME@YOURDOMAIN.COM
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set smtp=smtps://smtp.exmail.qq.com:465
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set smtp-auth=login
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set smtp-auth-user=USERNAME@YOURDOMAIN.COM
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set smtp-auth-password=YOURPASSWORD
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set ssl-verify=ignore
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set nss-config-dir=/etc/pki/nssdb/
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div><h4 id=发送邮件进行测试>发送邮件进行测试</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Your message&#34;</span> | mail -v -s <span style=color:#e6db74>&#34;Message Subject&#34;</span> email@address
</span></span></code></pre></div><p>如果出现 “Error in certificate: Peer&rsquo;s certificate issuer is not recognized” 属于正常。</p><h3 id=定期扫描>定期扫描</h3><p>使用 <code>crontab -e</code> 增加两个定时任务</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 每天凌晨 2 点半进行病毒库更新</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>30</span> <span style=color:#ae81ff>2</span> * * * /bin/freshclam
</span></span><span style=display:flex><span><span style=color:#75715e># 每天凌晨 3 点半进行病毒扫描</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>30</span> <span style=color:#ae81ff>3</span> * * * /bin/clamscan -ri &lt;/path1/to/scan&gt; | mail -s <span style=color:#e6db74>&#34;病毒文件扫描报告&#34;</span> <span style=color:#e6db74>&#39;youremailaddress&#39;</span>
</span></span></code></pre></div><p>如果不需要发送邮件使用下面的配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 每天凌晨 2 点半进行病毒库更新</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>30</span> <span style=color:#ae81ff>2</span> * * * /bin/freshclam
</span></span><span style=display:flex><span><span style=color:#75715e># 每天凌晨 3 点半进行病毒扫描</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>30</span> <span style=color:#ae81ff>3</span> * * * /bin/clamscan -ri &lt;/path1/to/scan&gt;
</span></span></code></pre></div></article></div></main></body></html>